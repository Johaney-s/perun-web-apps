<ng-template #spinner>
  <perun-web-apps-loading-dialog></perun-web-apps-loading-dialog>
</ng-template>
<div class="user-theme position-relative">
  <div *perunWebAppsLoader="loading; indicator: spinner">
    <h1 mat-dialog-title>
      {{'SHARED_LIB.PERUN.COMPONENTS.CHANGE_PASSWORD_DIALOG.TITLE' | translate}}
    </h1>
    <div class="dialog-container" mat-dialog-content>
      <form [formGroup]="formGroup">
        <div class="display-flex">
          <mat-form-field subscriptSizing="dynamic">
            <mat-label>
              {{'SHARED_LIB.PERUN.COMPONENTS.CHANGE_PASSWORD_DIALOG.OLD_PASSWORD' | translate}}
            </mat-label>
            <input
              formControlName="oldPasswordCtrl"
              matInput
              required
              [type]="showOldPassword ? 'text' : 'password'" />
            <mat-icon matSuffix (click)="showOldPassword = !showOldPassword">
              {{showOldPassword ? "visibility_off": "visibility"}}
            </mat-icon>
            <mat-error *ngIf="oldPwd.hasError('required')">
              {{'SHARED_LIB.PERUN.COMPONENTS.CHANGE_PASSWORD_DIALOG.FIELD_EMPTY' | translate}}</mat-error
            >
          </mat-form-field>

          <perun-web-apps-password-form [formGroup]="formGroup" [namespace]="data.namespace">
          </perun-web-apps-password-form>
        </div>
      </form>
    </div>

    <div mat-dialog-actions>
      <div class="ms-auto">
        <button (click)="close()" mat-button>
          {{'SHARED_LIB.PERUN.COMPONENTS.CHANGE_PASSWORD_DIALOG.CANCEL' | translate}}
        </button>
        <button
          (click)="changePassword()"
          [disabled]="formGroup.invalid || formGroup.pending || loading"
          class="ms-2"
          color="accent"
          mat-flat-button>
          {{'SHARED_LIB.PERUN.COMPONENTS.CHANGE_PASSWORD_DIALOG.CHANGE' | translate}}
        </button>
      </div>
    </div>
  </div>
</div>
