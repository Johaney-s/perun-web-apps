"use strict";(self.webpackChunkadmin_gui=self.webpackChunkadmin_gui||[]).push([[969],{61283:(W,x,i)=>{i.d(x,{A:()=>D});var e=i(36769),_=i(94650),S=i(94364);let D=(()=>{class a{prepareRoute(n){return n?.activatedRouteData&&null!==n?.activatedRouteData.animation}}return a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=_.Xpm({type:a,selectors:[["app-animated-router-outlet"]],decls:3,vars:0,consts:[["outlet","outlet"]],template:function(n,N){1&n&&(_.TgZ(0,"div"),_._UZ(1,"router-outlet",null,0),_.qZA())},dependencies:[S.lC],data:{animation:[e.Ji]}}),a})()},71103:(W,x,i)=>{i.d(x,{n:()=>m});var e=i(65412),_=i(95017),S=i(35382),D=i(32105),a=i(10036),n=(i(33604),i(94650)),N=i(89383),t=i(36895),U=i(4859),G=i(51572),C=i(98380),P=i(7434),E=i(53984);const Z=["list"];function F(g,I){1&g&&(n.TgZ(0,"perun-web-apps-alert",10),n._uU(1),n.ALo(2,"translate"),n.qZA()),2&g&&(n.xp6(1),n.hij(" ",n.lcZ(2,1,"DIALOGS.CREATE_ATTRIBUTE.ERROR_EMPTY_VALUE")," "))}function A(g,I){1&g&&n._UZ(0,"mat-spinner",11)}function v(g,I){if(1&g&&n._UZ(0,"perun-web-apps-attributes-list",12,13),2&g){const d=n.oxw();n.Q6J("emptyListText","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.EMPTY_ATTRIBUTES")("attributes",d.attributes)("filterValue",d.filterValue)("inDialog",!0)("selection",d.selected)("tableId",d.tableId)}}let m=(()=>{class g{constructor(d,b,l,f,y){this.dialogRef=d,this.data=b,this.attributesManager=l,this.notificator=f,this.translate=y,this.attributes=[],this.selected=new _.Ov(!0,[]),this.showError=!1,this.filterValue="",this.tableId=a.rF,this.translate.get("DIALOGS.CREATE_ATTRIBUTE.SUCCESS_SAVE").subscribe(B=>this.saveSuccessMessage=B)}ngOnInit(){const d=new Array;let b,l,f,y,B,J,h,M;switch(this.data.notEmptyAttributes.forEach(c=>{d.push(c.id)}),this.data.entity){case"member":b=this.data.entityId;break;case"user":l=this.data.entityId;break;case"vo":f=this.data.entityId;break;case"group":y=this.data.entityId;break;case"resource":B=this.data.entityId;break;case"facility":J=this.data.entityId;break;case"host":h=this.data.entityId;break;case"ues":M=this.data.entityId}switch(this.data.secondEntity){case"member":b=this.data.secondEntityId;break;case"user":l=this.data.secondEntityId;break;case"vo":f=this.data.secondEntityId;break;case"group":y=this.data.secondEntityId;break;case"resource":B=this.data.secondEntityId;break;case"facility":J=this.data.secondEntityId;break;case"host":h=this.data.secondEntityId;break;case"ues":M=this.data.secondEntityId}this.loading=!0,this.attributesManager.getAttributesDefinitionWithRights(b,l,f,y,B,J,h,M).subscribe(c=>{this.attributes=c,this.attributes=this.attributes.filter(o=>!d.includes(o.id)&&this.twoEntityValid(o)),this.loading=!1})}onCancel(){this.dialogRef.close()}onSave(){this.list.updateMapAttributes();let d=!1;for(const b of this.selected.selected)"java.util.ArrayList"===b.type&&0===b.value.length&&(d=!0),void 0===b.value&&(d=!0);if(d)return this.showError=!0,void setTimeout(()=>{this.showError=!1},5e3);switch(this.data.entity){case"facility":this.attributesManager.setFacilityAttributes({facility:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":"resource"===this.data.secondEntity?this.attributesManager.setGroupResourceAttributes({group:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setGroupAttributes({group:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.setMemberResourceAttributes({member:this.data.entityId,resource:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"group":this.attributesManager.setMemberGroupAttributes({member:this.data.entityId,group:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;default:this.attributesManager.setMemberAttributes({member:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}break;case"resource":this.attributesManager.setResourceAttributes({resource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"user":"facility"===this.data.secondEntity?this.attributesManager.setUserFacilityAttributes({user:this.data.entityId,facility:this.data.secondEntityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()}):this.attributesManager.setUserAttributes({user:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"vo":this.attributesManager.setVoAttributes({vo:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"host":this.attributesManager.setHostAttributes({host:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()});break;case"ues":this.attributesManager.setUserExtSourceAttributes({userExtSource:this.data.entityId,attributes:this.selected.selected}).subscribe(()=>{this.handleSuccess()})}}applyFilter(d){this.filterValue=d}handleSuccess(){this.notificator.showSuccess(this.saveSuccessMessage),this.selected.clear(),this.dialogRef.close("saved")}twoEntityValid(d){return!this.data.secondEntity||d.entity===`${this.data.entity}_${this.data.secondEntity}`}}return g.\u0275fac=function(d){return new(d||g)(n.Y36(e.so),n.Y36(e.WI),n.Y36(D.H8),n.Y36(S.V6),n.Y36(N.sK))},g.\u0275cmp=n.Xpm({type:g,selectors:[["app-create-attribute-dialog"]],viewQuery:function(d,b){if(1&d&&n.Gf(Z,5),2&d){let l;n.iGM(l=n.CRH())&&(b.list=l.first)}},decls:17,vars:17,consts:[["mat-dialog-title",""],[1,"page-subtitle"],["data-cy","filter-attributes",1,"font-size-1rem",3,"placeholder","filter"],["class","ml-3 font-size-1rem","alert_type","error",4,"ngIf"],["mat-dialog-content",""],["class","ml-auto mr-auto",4,"ngIf"],[3,"emptyListText","attributes","filterValue","inDialog","selection","tableId",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","data-cy","save-selected-attributes","mat-flat-button","",1,"ml-2",3,"disabled","click"],["alert_type","error",1,"ml-3","font-size-1rem"],[1,"ml-auto","mr-auto"],[3,"emptyListText","attributes","filterValue","inDialog","selection","tableId"],["list",""]],template:function(d,b){1&d&&(n.TgZ(0,"div")(1,"div",0)(2,"h1",1),n._uU(3),n.ALo(4,"translate"),n.qZA(),n.TgZ(5,"perun-web-apps-immediate-filter",2),n.NdJ("filter",function(f){return b.applyFilter(f)}),n.qZA(),n.YNc(6,F,3,3,"perun-web-apps-alert",3),n.qZA(),n.TgZ(7,"div",4),n.YNc(8,A,1,0,"mat-spinner",5),n.YNc(9,v,2,6,"perun-web-apps-attributes-list",6),n.qZA(),n.TgZ(10,"div",7)(11,"button",8),n.NdJ("click",function(){return b.onCancel()}),n._uU(12),n.ALo(13,"translate"),n.qZA(),n.TgZ(14,"button",9),n.NdJ("click",function(){return b.onSave()}),n._uU(15),n.ALo(16,"translate"),n.qZA()()()),2&d&&(n.Tol(b.data.style),n.xp6(3),n.Oqu(n.lcZ(4,11,"DIALOGS.CREATE_ATTRIBUTE.SET_NEW")),n.xp6(2),n.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),n.xp6(1),n.Q6J("ngIf",b.showError),n.xp6(2),n.Q6J("ngIf",b.loading),n.xp6(1),n.Q6J("ngIf",!b.loading),n.xp6(3),n.hij(" ",n.lcZ(13,13,"DIALOGS.CREATE_ATTRIBUTE.CANCEL")," "),n.xp6(2),n.Q6J("disabled",0===b.selected.selected.length),n.xp6(1),n.hij(" ",n.lcZ(16,15,"DIALOGS.CREATE_ATTRIBUTE.SAVE")," "))},dependencies:[t.O5,U.lW,e.uh,e.xY,e.H8,G.Ou,C.w,P.L,E.p,N.X$],styles:[".font-size-1rem[_ngcontent-%COMP%]{font-size:1rem!important}"]}),g})()},61365:(W,x,i)=>{i.d(x,{k:()=>F});var e=i(65412),_=i(30671),S=i(35382),D=i(32105),a=i(94650),L=i(89383),n=i(36895),N=i(4859),t=i(51572);function U(A,v){1&A&&a._UZ(0,"mat-spinner",6)}function G(A,v){1&A&&a._UZ(0,"th",15)}function C(A,v){if(1&A&&(a.TgZ(0,"td",16),a._uU(1),a.qZA()),2&A){const m=v.$implicit;a.xp6(1),a.Oqu(m.displayName)}}function P(A,v){1&A&&a._UZ(0,"tr",17)}function E(A,v){1&A&&a._UZ(0,"tr",18)}function Z(A,v){if(1&A&&(a.TgZ(0,"div",7)(1,"div"),a._uU(2),a.ALo(3,"translate"),a.qZA(),a.TgZ(4,"div",8),a._uU(5),a.ALo(6,"translate"),a.qZA(),a.TgZ(7,"table",9),a.ynx(8,10),a.YNc(9,G,1,0,"th",11),a.YNc(10,C,2,1,"td",12),a.BQk(),a.YNc(11,P,1,0,"tr",13),a.YNc(12,E,1,0,"tr",14),a.qZA()()),2&A){const m=a.oxw();a.xp6(2),a.hij(" ",a.lcZ(3,5,"DIALOGS.DELETE_ATTRIBUTES.DESCRIPTION")," "),a.xp6(3),a.hij(" ",a.lcZ(6,7,"DIALOGS.DELETE_ATTRIBUTES.ASK")," "),a.xp6(2),a.Q6J("dataSource",m.dataSource),a.xp6(4),a.Q6J("matHeaderRowDef",m.displayedColumns),a.xp6(1),a.Q6J("matRowDefColumns",m.displayedColumns)}}let F=(()=>{class A{constructor(m,g,I,d,b){this.dialogRef=m,this.data=g,this.notificator=I,this.translate=d,this.attributesManager=b,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.dataSource=new _.by(this.data.attributes),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){const m=[];for(const I of this.data.attributes)m.push(I.id);const g={};switch(g[this.data.entity]=this.data.entityId,g.attributes=m,void 0!==this.data.secondEntity&&(g[this.data.secondEntity]=this.data.secondEntityId),this.loading=!0,this.data.entity){case"vo":this.attributesManager.removeVoAttributes(this.data.entityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"group":"resource"===this.data.secondEntity?this.attributesManager.removeGroupResourceAttributes(this.data.entityId,this.data.secondEntityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1):this.attributesManager.removeGroupAttributes(this.data.entityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"user":"facility"===this.data.secondEntity?this.attributesManager.removeUserFacilityAttributes(this.data.entityId,this.data.secondEntityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1):this.attributesManager.removeUserAttributes(this.data.entityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"member":switch(this.data.secondEntity){case"resource":this.attributesManager.removeMemberResourceAttributes(this.data.entityId,this.data.secondEntityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"group":this.attributesManager.removeMemberGroupAttributes(this.data.entityId,this.data.secondEntityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;default:this.attributesManager.removeMemberAttributes(this.data.entityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1)}break;case"facility":this.attributesManager.removeFacilityAttributes(this.data.entityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"host":this.attributesManager.removeHostAttributes(this.data.entityId,m).subscribe(()=>{this.onSuccess()},()=>this.loading=!1);break;case"ues":this.attributesManager.removeUesAttributes(this.data.entityId,m).subscribe({next:()=>{this.onSuccess()},error:()=>this.loading=!1});break;case"resource":this.attributesManager.removeResourceAttributes(this.data.entityId,m).subscribe({next:()=>this.onSuccess(),error:()=>this.loading=!1})}}onSuccess(){this.translate.get("DIALOGS.DELETE_ATTRIBUTES.SUCCESS").subscribe(m=>{this.notificator.showSuccess(m),this.dialogRef.close(!0)})}}return A.\u0275fac=function(m){return new(m||A)(a.Y36(e.so),a.Y36(e.WI),a.Y36(S.V6),a.Y36(L.sK),a.Y36(D.H8))},A.\u0275cmp=a.Xpm({type:A,selectors:[["app-delete-attribute-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","data-cy","delete-attributes","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(m,g){1&m&&(a.TgZ(0,"div")(1,"h1",0),a._uU(2),a.ALo(3,"translate"),a.qZA(),a.YNc(4,U,1,0,"mat-spinner",1),a.YNc(5,Z,13,9,"div",2),a.TgZ(6,"div",3)(7,"button",4),a.NdJ("click",function(){return g.onCancel()}),a._uU(8),a.ALo(9,"translate"),a.qZA(),a.TgZ(10,"button",5),a.NdJ("click",function(){return g.onSubmit()}),a._uU(11),a.ALo(12,"translate"),a.qZA()()()),2&m&&(a.Tol(g.theme),a.xp6(2),a.Oqu(a.lcZ(3,9,"DIALOGS.DELETE_ATTRIBUTES.TITLE")),a.xp6(2),a.Q6J("ngIf",g.loading),a.xp6(1),a.Q6J("ngIf",!g.loading),a.xp6(3),a.hij(" ",a.lcZ(9,11,"DIALOGS.DELETE_ATTRIBUTES.CANCEL")," "),a.xp6(2),a.Q6J("disabled",g.loading),a.xp6(1),a.hij(" ",a.lcZ(12,13,"DIALOGS.DELETE_ATTRIBUTES.DELETE")," "))},dependencies:[n.O5,N.lW,_.BZ,_.fO,_.as,_.w1,_.Dz,_.nj,_.ge,_.ev,_.XQ,_.Gk,e.uh,e.xY,e.H8,t.Ou,L.X$]}),A})()},95406:(W,x,i)=>{i.d(x,{r:()=>J});var e=i(94650),_=i(24006),S=i(9244),D=i(28499),a=i(32105),L=i(35382),n=i(10266),N=i(71948),t=i(13469),U=i(78372),G=i(95698),C=i(63900),P=i(54004),E=i(36895),Z=i(3238),F=i(59549),A=i(284),v=i(84385),m=i(89383);function g(h,M){if(1&h&&(e.TgZ(0,"mat-option",7),e._uU(1),e.qZA()),2&h){const c=M.$implicit;e.Q6J("value",c),e.xp6(1),e.hij(" ",c," ")}}function I(h,M){1&h&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&h&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.FIELD_EMPTY")))}function d(h,M){1&h&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&h&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_EXISTS")))}function b(h,M){1&h&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&h&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_FORMAT")))}function l(h,M){1&h&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&h&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_LONG")))}function f(h,M){1&h&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&h&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_SHORT")))}function y(h,M){if(1&h&&(e.TgZ(0,"span",8),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&h){const c=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,"Not selected"===c.formGroup.get("namespaceCtrl").value?"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED":"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN_DISABLED_FOR_NAMESPACE")," ")}}let B=(()=>{class h{constructor(c,o){this.membersManagerService=c,this.usersManagerService=o,this.filteredNamespaces=null,this.namespaceChanged=new e.vpe,this.parsedRulesChanged=new e.vpe,this.namespaceOptions=[],this.selectedNamespace=null,this.namespaceRules=[],this.parsedRules=new Map}ngOnInit(){this.namespaceOptions=["Not selected"],this.membersManagerService.getAllNamespacesRules().subscribe(c=>{this.namespaceRules=c,this.parseNamespaceRules()}),this.onNamespaceChanged("Not selected")}existingLoginValidator(){return c=>{let o=this.formGroup.get("namespaceCtrl").value.toLowerCase();return o="not selected"===o?"mu":o,c.valueChanges.pipe((0,U.b)(500),(0,G.q)(1),(0,C.w)(()=>this.usersManagerService.isLoginAvailable(o,c.value).pipe((0,P.U)(R=>R?null:{loginExists:!0}))))}}parseNamespaceRules(){for(const c of this.namespaceRules)if(null===this.filteredNamespaces||!this.filteredNamespaces.includes(c.namespaceName)){this.namespaceOptions.push(c.namespaceName);const o={login:"disabled"};this.parseAttributes(o,c.requiredAttributes,"required"),this.parseAttributes(o,c.optionalAttributes,"optional"),this.parsedRules.set(c.namespaceName,o)}this.parsedRulesChanged.emit(this.parsedRules)}parseAttributes(c,o,R){for(const w of o)"login"===w&&(c.login=R)}onNamespaceChanged(c){this.selectedNamespace=c.toLowerCase();const o=this.formGroup.get("loginCtrl");if("Not selected"!==c)if("disabled"===this.parsedRules.get(this.selectedNamespace).login)o.disable(),o.setValue("");else{const R=[_.kI.required,_.kI.pattern("^[a-z][a-z0-9_-]+$"),_.kI.maxLength(15),_.kI.minLength(2)];(0,S.mH)(o,R,[this.existingLoginValidator()])}else o.disable(),o.setValue("");this.namespaceChanged.emit(c)}}return h.\u0275fac=function(c){return new(c||h)(e.Y36(a.uq),e.Y36(a.Fv))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-login-for-namespace"]],inputs:{formGroup:"formGroup",filteredNamespaces:"filteredNamespaces"},outputs:{namespaceChanged:"namespaceChanged",parsedRulesChanged:"parsedRulesChanged"},decls:18,vars:16,consts:[[1,"display-flex",3,"formGroup"],["formControlName","namespaceCtrl",3,"valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"floatLabel"],["formControlName","loginCtrl","matInput","","required","",3,"hidden"],[4,"ngIf"],["class","input-disabled",4,"ngIf"],[3,"value"],[1,"input-disabled"]],template:function(c,o){1&c&&(e.TgZ(0,"div",0)(1,"mat-form-field")(2,"mat-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"mat-select",1),e.NdJ("valueChange",function(w){return o.onNamespaceChanged(w)}),e.YNc(6,g,2,2,"mat-option",2),e.qZA()(),e.TgZ(7,"mat-form-field",3)(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e._UZ(11,"input",4),e.YNc(12,I,3,3,"mat-error",5),e.YNc(13,d,3,3,"mat-error",5),e.YNc(14,b,3,3,"mat-error",5),e.YNc(15,l,3,3,"mat-error",5),e.YNc(16,f,3,3,"mat-error",5),e.YNc(17,y,3,3,"span",6),e.qZA()()),2&c&&(e.Q6J("formGroup",o.formGroup),e.xp6(3),e.Oqu(e.lcZ(4,12,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.NAMESPACE")),e.xp6(3),e.Q6J("ngForOf",o.namespaceOptions),e.xp6(1),e.Q6J("floatLabel",o.formGroup.get("loginCtrl").disabled?"always":null),e.xp6(2),e.Oqu(e.lcZ(10,14,"SHARED.COMPONENTS.LOGIN_FOR_NAMESPACE.LOGIN")),e.xp6(2),e.Q6J("hidden",o.formGroup.get("loginCtrl").disabled),e.xp6(1),e.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("required")),e.xp6(1),e.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("loginExists")),e.xp6(1),e.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("pattern")&&!o.formGroup.get("loginCtrl").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("maxlength")),e.xp6(1),e.Q6J("ngIf",o.formGroup.get("loginCtrl").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",o.formGroup.get("loginCtrl").disabled))},dependencies:[E.sg,E.O5,Z.ey,F.TO,F.KE,F.hX,A.Nt,_.Fj,_.JJ,_.JL,_.Q7,_.sg,_.u,v.gD,m.X$],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-disabled[_ngcontent-%COMP%]{pointer-events:none;color:#888}"]}),h})(),J=(()=>{class h{constructor(c,o,R){this.membersManagerService=c,this.usersManagerService=o,this.apiRequestConfiguration=R,this.filteredNamespace=null,this.parsedRulesOutput=new e.vpe,this.selectedNamespace=null,this.parsedRules=new Map}parsedRulesFunction(c){this.parsedRules=c,this.parsedRulesOutput.emit(c)}onNamespaceChanged(c){this.selectedNamespace=c.toLowerCase();const o=this.formGroup.get("passwordCtrl"),R=this.formGroup.get("passwordAgainCtrl"),w=this.formGroup.get("generatePasswordCtrl");"Not selected"!==c?((0,S.mH)(w,[]),this.passwordOptionChanged()):(o.disable(),o.setValue(""),R.disable(),R.setValue(""),w.disable(),w.dirty||w.setValue(!0))}passwordOptionChanged(){const c=this.formGroup.get("passwordCtrl"),o=this.formGroup.get("passwordAgainCtrl");this.formGroup.get("generatePasswordCtrl").value?(c.disable(),c.setValue(""),o.disable(),o.setValue("")):((0,S.mH)(c,[_.kI.required],[(0,D.yT)(this.selectedNamespace,this.usersManagerService,this.apiRequestConfiguration)]),(0,S.mH)(o,[]))}}return h.\u0275fac=function(c){return new(c||h)(e.Y36(a.uq),e.Y36(a.Fv),e.Y36(L.F5))},h.\u0275cmp=e.Xpm({type:h,selectors:[["app-login-password-form-with-generate-option"]],inputs:{formGroup:"formGroup",filteredNamespace:"filteredNamespace"},outputs:{parsedRulesOutput:"parsedRulesOutput"},decls:12,vars:23,consts:[[1,"display-flex",3,"formGroup"],[3,"formGroup","filteredNamespaces","namespaceChanged","parsedRulesChanged"],["formControlName","generatePasswordCtrl","matTooltipPosition","left",1,"display-flex","mt-3",3,"matTooltipDisabled","matTooltip","ngModelChange"],[3,"checked","value"],[1,"display-flex"],[3,"formGroup","namespace","passwordRequired","tooltipPwdDisabledForNamespace"]],template:function(c,o){1&c&&(e.TgZ(0,"div",0)(1,"app-login-for-namespace",1),e.NdJ("namespaceChanged",function(w){return o.onNamespaceChanged(w)})("parsedRulesChanged",function(w){return o.parsedRulesFunction(w)}),e.qZA(),e.TgZ(2,"mat-radio-group",2),e.NdJ("ngModelChange",function(){return o.passwordOptionChanged()}),e.ALo(3,"translate"),e.TgZ(4,"mat-radio-button",3),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"mat-radio-button",3),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e.TgZ(10,"div",4),e._UZ(11,"perun-web-apps-password-form",5),e.qZA()()),2&c&&(e.Q6J("formGroup",o.formGroup),e.xp6(1),e.Q6J("formGroup",o.formGroup)("filteredNamespaces",o.filteredNamespace),e.xp6(1),e.s9C("matTooltip",e.lcZ(3,17,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_NOT_SUPPORTED")),e.Q6J("matTooltipDisabled","Not selected"!==o.formGroup.get("namespaceCtrl").value),e.xp6(2),e.Q6J("checked",o.formGroup.get("generatePasswordCtrl").value&&o.formGroup.get("generatePasswordCtrl").enabled)("value",!0),e.xp6(1),e.hij(" ",e.lcZ(6,19,"DIALOGS.CREATE_SERVICE_MEMBER.PASSWORD_RANDOM")," "),e.xp6(2),e.Q6J("checked",!o.formGroup.get("generatePasswordCtrl").value&&o.formGroup.get("generatePasswordCtrl").enabled)("value",!1),e.xp6(1),e.hij(" ",e.lcZ(9,21,"DIALOGS.CREATE_SERVICE_MEMBER.ENTER_PASSWORD")," "),e.xp6(2),e.ekj("input-disabled",o.formGroup.get("generatePasswordCtrl").value),e.xp6(1),e.Q6J("formGroup",o.formGroup)("namespace",o.selectedNamespace)("passwordRequired",!o.formGroup.get("generatePasswordCtrl").value)("tooltipPwdDisabledForNamespace",o.formGroup.get("generatePasswordCtrl").enabled))},dependencies:[_.JJ,_.JL,_.sg,_.u,n.gM,N.VQ,N.U0,t.G,B,m.X$],styles:[".display-flex[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),h})()},12651:(W,x,i)=>{i.d(x,{t:()=>I});var e=i(32105),_=i(95017),S=i(9244),D=i(71103),a=i(74281),L=i(61365),N=(i(33604),i(10036)),t=i(94650),U=i(65412),G=i(36895),C=i(4859),P=i(51572),E=i(96214),Z=i(7434),F=i(53984),A=i(89383);const v=["list"];function m(d,b){1&d&&t._UZ(0,"mat-spinner",7)}function g(d,b){if(1&d&&t._UZ(0,"perun-web-apps-attributes-list",8,9),2&d){const l=t.oxw();t.Q6J("attributes",l.attributes)("filterValue",l.filterValue)("selection",l.selection)("tableId",l.tableId)}}let I=(()=>{class d{constructor(l,f){this.attributesManagerService=l,this.dialog=f,this.attributes=[],this.selection=new _.Ov(!0,[]),this.filterValue="",this.tableId=N.rF,this.loading=!1}ngOnInit(){this.refreshTable()}refreshTable(){switch(this.loading=!0,this.entity){case"member":this.attributesManagerService.getMemberAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"group":this.attributesManagerService.getGroupAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"user":this.attributesManagerService.getUserAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"resource":this.attributesManagerService.getResourceAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"facility":this.attributesManagerService.getFacilityAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1});break;case"vo":this.attributesManagerService.getVoAttributes(this.entityId).subscribe(l=>{this.attributes=l,this.selection.clear(),this.loading=!1})}}applyFilter(l){this.filterValue=l}onCreate(){const l=(0,S.kZ)();l.width="1050px",l.data={entityId:this.entityId,entity:this.entity,notEmptyAttributes:this.attributes,style:this.entity+"-theme"},this.dialog.open(D.n,l).afterClosed().subscribe(y=>{y&&this.refreshTable()})}onSave(){this.list.updateMapAttributes();const l=(0,S.kZ)();l.width="450px",l.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(a.wA,l).afterClosed().subscribe(y=>{y&&this.refreshTable()})}onDelete(){const l=(0,S.kZ)();l.width="450px",l.data={entityId:this.entityId,entity:this.entity,attributes:this.selection.selected},this.dialog.open(L.k,l).afterClosed().subscribe(y=>{y&&this.refreshTable()})}}return d.\u0275fac=function(l){return new(l||d)(t.Y36(e.H8),t.Y36(U.uw))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-one-entity-attribute-page"]],viewQuery:function(l,f){if(1&l&&t.Gf(v,5),2&l){let y;t.iGM(y=t.CRH())&&(f.list=y.first)}},inputs:{entity:"entity",entityId:"entityId"},decls:13,vars:14,consts:[[1,"mt-2",3,"refresh"],["color","accent","data-cy","add-attributes","mat-flat-button","",1,"mr-2","mt-2","action-button",3,"click"],["color","accent","mat-flat-button","",1,"mr-2","mt-2",3,"disabled","click"],["color","warn","data-cy","remove-attributes","mat-flat-button","",1,"mt-2","mr-2",3,"disabled","click"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"attributes","filterValue","selection","tableId",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"attributes","filterValue","selection","tableId"],["list",""]],template:function(l,f){1&l&&(t.TgZ(0,"perun-web-apps-refresh-button",0),t.NdJ("refresh",function(){return f.refreshTable()}),t.qZA(),t.TgZ(1,"button",1),t.NdJ("click",function(){return f.onCreate()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){return f.onSave()}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",3),t.NdJ("click",function(){return f.onDelete()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"perun-web-apps-immediate-filter",4),t.NdJ("filter",function(B){return f.applyFilter(B)}),t.qZA(),t.YNc(11,m,1,0,"mat-spinner",5),t.YNc(12,g,2,4,"perun-web-apps-attributes-list",6)),2&l&&(t.xp6(2),t.hij(" ",t.lcZ(3,8,"USER_DETAIL.SETTINGS.ATTRIBUTES.CREATE"),"\n"),t.xp6(2),t.Q6J("disabled",0===f.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(6,10,"USER_DETAIL.SETTINGS.ATTRIBUTES.SAVE"),"\n"),t.xp6(2),t.Q6J("disabled",0===f.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(9,12,"USER_DETAIL.SETTINGS.ATTRIBUTES.DELETE"),"\n"),t.xp6(2),t.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),t.xp6(1),t.Q6J("ngIf",f.loading),t.xp6(1),t.Q6J("ngIf",!f.loading))},dependencies:[G.O5,C.lW,P.Ou,E.t,Z.L,F.p,A.X$]}),d})()},19191:(W,x,i)=>{i.d(x,{Y:()=>K});var e=i(32105),S=(i(33604),i(95017)),D=i(61365),a=i(9244),L=i(74281),n=i(71103),N=i(64080),t=i(94650),U=i(65412),G=i(36895),C=i(4859),P=i(51572),E=i(98380),Z=i(96214),F=i(7434),A=i(53984),v=i(82322),m=i(45703),g=i(42377),I=i(89383);let d=(()=>{class u{constructor(){this.memberSelected=new t.vpe,this.memberFullNameFunction=s=>(0,a.bD)(s.user)}ngOnInit(){this.members=this.members.sort(a.fx)}}return u.\u0275fac=function(s){return new(s||u)},u.\u0275cmp=t.Xpm({type:u,selectors:[["perun-web-apps-member-search-select"]],inputs:{members:"members"},outputs:{memberSelected:"memberSelected"},decls:4,vars:12,consts:[[3,"entities","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(s,r){1&s&&(t.TgZ(0,"perun-web-apps-entity-search-select",0),t.NdJ("entitySelected",function(T){return r.memberSelected.emit(T)}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&s&&t.Q6J("entities",r.members)("searchFunction",r.memberFullNameFunction)("mainTextFunction",r.memberFullNameFunction)("selectPlaceholder",t.lcZ(1,6,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.SELECT_MEMBER"))("findPlaceholder",t.lcZ(2,8,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.FIND_MEMBER"))("noEntriesText",t.lcZ(3,10,"SHARED_LIB.PERUN.COMPONENTS.MEMBER_SEARCH_SELECT.NO_MEMBER_FOUND"))},dependencies:[g.i,I.X$]}),u})(),b=(()=>{class u{constructor(){this.facilitySelected=new t.vpe,this.nameFunction=s=>s.name}ngOnInit(){this.facilities=this.facilities.sort(a.aC)}}return u.\u0275fac=function(s){return new(s||u)},u.\u0275cmp=t.Xpm({type:u,selectors:[["perun-web-apps-facility-search-select"]],inputs:{facilities:"facilities"},outputs:{facilitySelected:"facilitySelected"},decls:4,vars:12,consts:[[3,"entities","searchFunction","mainTextFunction","selectPlaceholder","findPlaceholder","noEntriesText","entitySelected"]],template:function(s,r){1&s&&(t.TgZ(0,"perun-web-apps-entity-search-select",0),t.NdJ("entitySelected",function(T){return r.facilitySelected.emit(T)}),t.ALo(1,"translate"),t.ALo(2,"translate"),t.ALo(3,"translate"),t.qZA()),2&s&&t.Q6J("entities",r.facilities)("searchFunction",r.nameFunction)("mainTextFunction",r.nameFunction)("selectPlaceholder",t.lcZ(1,6,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.SELECT_FACILITY"))("findPlaceholder",t.lcZ(2,8,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.FIND_FACILITY"))("noEntriesText",t.lcZ(3,10,"SHARED_LIB.PERUN.COMPONENTS.FACILITY_SEARCH_SELECT.NO_FACILITY_FOUND"))},dependencies:[g.i,I.X$]}),u})();var l=i(74250);const f=["list"];function y(u,O){1&u&&t._UZ(0,"mat-spinner",4)}function B(u,O){if(1&u&&(t.TgZ(0,"perun-web-apps-alert",5),t._uU(1),t.qZA()),2&u){const s=t.oxw();t.xp6(1),t.Oqu(s.noEntityMessage)}}function J(u,O){if(1&u){const s=t.EpF();t.TgZ(0,"perun-web-apps-group-search-select",18),t.NdJ("groupSelected",function(p){t.CHM(s);const T=t.oxw(2);return t.KtG(T.specifySecondEntity(p))}),t.qZA()}if(2&u){const s=t.oxw(2);t.Q6J("firstSelectedGroup",s.specificSecondEntity)("displayStatus",!0)("groups",s.entityValues)}}function h(u,O){if(1&u){const s=t.EpF();t.TgZ(0,"perun-web-apps-resource-search-select",19),t.NdJ("resourceSelected",function(p){t.CHM(s);const T=t.oxw(2);return t.KtG(T.specifySecondEntity(p))}),t.qZA()}if(2&u){const s=t.oxw(2);t.Q6J("resources",s.entityValues)}}function M(u,O){if(1&u){const s=t.EpF();t.TgZ(0,"perun-web-apps-member-search-select",20),t.NdJ("memberSelected",function(p){t.CHM(s);const T=t.oxw(2);return t.KtG(T.specifySecondEntity(p))}),t.qZA()}if(2&u){const s=t.oxw(2);t.Q6J("members",s.entityValues)}}function c(u,O){if(1&u){const s=t.EpF();t.TgZ(0,"perun-web-apps-facility-search-select",21),t.NdJ("facilitySelected",function(p){t.CHM(s);const T=t.oxw(2);return t.KtG(T.specifySecondEntity(p))}),t.qZA()}if(2&u){const s=t.oxw(2);t.Q6J("facilities",s.entityValues)}}function o(u,O){if(1&u){const s=t.EpF();t.TgZ(0,"perun-web-apps-user-search-select",22),t.NdJ("userSelected",function(p){t.CHM(s);const T=t.oxw(2);return t.KtG(T.specifySecondEntity(p))}),t.qZA()}if(2&u){const s=t.oxw(2);t.Q6J("users",s.entityValues)}}function R(u,O){1&u&&t._UZ(0,"mat-spinner",4)}function w(u,O){if(1&u&&t._UZ(0,"perun-web-apps-attributes-list",23,24),2&u){const s=t.oxw(2);t.Q6J("attributes",s.attributes)("filterValue",s.filterValue)("selection",s.selection)}}function Q(u,O){if(1&u){const s=t.EpF();t.TgZ(0,"div")(1,"div",6),t.YNc(2,J,1,3,"perun-web-apps-group-search-select",7),t.YNc(3,h,1,1,"perun-web-apps-resource-search-select",8),t.YNc(4,M,1,1,"perun-web-apps-member-search-select",9),t.YNc(5,c,1,1,"perun-web-apps-facility-search-select",10),t.YNc(6,o,1,1,"perun-web-apps-user-search-select",11),t.qZA(),t.TgZ(7,"perun-web-apps-refresh-button",12),t.NdJ("refresh",function(){t.CHM(s);const p=t.oxw();return t.KtG(p.getAttributes(p.specificSecondEntity.id))}),t.qZA(),t.TgZ(8,"button",13),t.NdJ("click",function(){t.CHM(s);const p=t.oxw();return t.KtG(p.onAdd(p.specificSecondEntity.id))}),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"button",14),t.NdJ("click",function(){t.CHM(s);const p=t.oxw();return t.KtG(p.onSave(p.specificSecondEntity.id))}),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"button",15),t.NdJ("click",function(){t.CHM(s);const p=t.oxw();return t.KtG(p.onDelete(p.specificSecondEntity.id))}),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"perun-web-apps-immediate-filter",16),t.NdJ("filter",function(p){t.CHM(s);const T=t.oxw();return t.KtG(T.applyFilter(p))}),t.qZA(),t.YNc(18,R,1,0,"mat-spinner",1),t.YNc(19,w,2,3,"perun-web-apps-attributes-list",17),t.qZA()}if(2&u){const s=t.oxw();t.xp6(2),t.Q6J("ngIf","group"===s.secondEntity),t.xp6(1),t.Q6J("ngIf","resource"===s.secondEntity),t.xp6(1),t.Q6J("ngIf","member"===s.secondEntity),t.xp6(1),t.Q6J("ngIf","facility"===s.secondEntity),t.xp6(1),t.Q6J("ngIf","user"===s.secondEntity),t.xp6(3),t.hij(" ",t.lcZ(10,13,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.CREATE")," "),t.xp6(2),t.Q6J("disabled",0===s.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(13,15,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.SAVE")," "),t.xp6(2),t.Q6J("disabled",0===s.selection.selected.length),t.xp6(1),t.hij(" ",t.lcZ(16,17,"MEMBER_DETAIL.SETTINGS.ATTRIBUTES.DELETE")," "),t.xp6(2),t.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.ATTRIBUTES_LIST.FILTER"),t.xp6(1),t.Q6J("ngIf",s.innerLoading),t.xp6(1),t.Q6J("ngIf",!s.innerLoading)}}let K=(()=>{class u{constructor(s,r,p,T,V,Y){this.attributesManagerService=s,this.resourcesManagerService=r,this.facilitiesManagerService=p,this.groupsManagerService=T,this.membersManager=V,this.dialog=Y,this.entityValues=[],this.attributes=[],this.selection=new S.Ov(!0,[]),this.allowedStatuses=["INVALID","VALID"],this.loading=!1,this.innerLoading=!1,this.filterValue=""}ngOnInit(){this.loadEntityValues(),this.setMessages(this.secondEntity.toLowerCase())}loadEntityValues(){switch(this.loading=!0,this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.resourcesManagerService.getAssignedResourcesWithStatus(this.firstEntityId).subscribe(s=>{this.entityValues=s.map(r=>r.enrichedResource.resource),this.preselectEntity(),this.loading=!1});break;case"group":this.groupsManagerService.getMemberGroups(this.firstEntityId).subscribe(s=>{this.entityValues=s,this.preselectEntity(),this.loading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.resourcesManagerService.getResourceAssignments(this.firstEntityId).subscribe(s=>{this.entityValues=s.map(r=>{const p=r.enrichedResource.resource;return p.status=r.status,p}),this.preselectEntity(),this.loading=!1});break;case"member":this.membersManager.getCompleteRichMembersForGroup(this.firstEntityId,!1,this.allowedStatuses,null,[N.r.MEMBER_CORE_ID]).subscribe(s=>{this.entityValues=s,this.preselectEntity(),this.loading=!1})}break;case"user":this.facilitiesManagerService.getAssignedFacilitiesByUser(this.firstEntityId).subscribe(s=>{this.entityValues=s,this.preselectEntity(),this.loading=!1});break;case"resource":switch(this.secondEntity){case"member":this.resourcesManagerService.getAssignedMembersWithStatus(this.firstEntityId).subscribe(s=>{this.entityValues=s.map(r=>r.richMember),this.preselectEntity(),this.loading=!1});break;case"group":this.resourcesManagerService.getGroupAssignments(this.firstEntityId).subscribe(s=>{this.entityValues=s.map(r=>{const p=r.enrichedGroup.group;return p.status=r.status,p}),this.preselectEntity(),this.loading=!1})}break;case"facility":this.facilitiesManagerService.getAssignedUsers(this.firstEntityId).subscribe(s=>{this.entityValues=s,this.preselectEntity(),this.loading=!1})}}preselectEntity(){0!==this.entityValues.length&&this.findInitiallySelectedEntity()}findInitiallySelectedEntity(){let s=this.entityValues[0];const r=(0,a.vL)(this.entityKey());if(r)for(const p of this.entityValues)if(p.id===r[0]){s=p;break}this.specifySecondEntity(s)}entityKey(){return"group"===this.secondEntity?"groups":""}getAttributes(s){switch(this.innerLoading=!0,this.selection.clear(),this.firstEntity){case"member":switch(this.secondEntity){case"resource":this.attributesManagerService.getMemberResourceAttributes(this.firstEntityId,s).subscribe(r=>{this.attributes=r,this.innerLoading=!1});break;case"group":this.attributesManagerService.getMemberGroupAttributes(this.firstEntityId,s).subscribe(r=>{this.attributes=r,this.innerLoading=!1})}break;case"group":switch(this.secondEntity){case"resource":this.attributesManagerService.getGroupResourceAttributes(this.firstEntityId,s).subscribe(r=>{this.attributes=r,this.innerLoading=!1});break;case"member":this.attributesManagerService.getMemberGroupAttributes(s,this.firstEntityId).subscribe(r=>{this.attributes=r,this.innerLoading=!1})}break;case"user":this.attributesManagerService.getUserFacilityAttributes(this.firstEntityId,s).subscribe(r=>{this.attributes=r,this.innerLoading=!1});break;case"resource":switch(this.secondEntity){case"member":this.attributesManagerService.getMemberResourceAttributes(s,this.firstEntityId).subscribe(r=>{this.attributes=r,this.innerLoading=!1});break;case"group":this.attributesManagerService.getGroupResourceAttributes(s,this.firstEntityId).subscribe(r=>{this.attributes=r,this.innerLoading=!1})}break;case"facility":this.attributesManagerService.getUserFacilityAttributes(s,this.firstEntityId).subscribe(r=>{this.attributes=r,this.innerLoading=!1})}}setMessages(s){this.noEntityMessage=`No ${s} assigned`}onSave(s){this.list.updateMapAttributes();const r=(0,a.kZ)();r.width="450px",r.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:s,attributes:this.selection.selected},this.dialog.open(L.wA,r).afterClosed().subscribe(T=>{T&&(this.selection.clear(),this.getAttributes(s))})}onDelete(s){const r=(0,a.kZ)();r.width="450px",r.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:s,attributes:this.selection.selected,theme:`${this.firstEntity}-theme`},this.dialog.open(D.k,r).afterClosed().subscribe(T=>{T&&(this.selection.clear(),this.getAttributes(s))})}onAdd(s){const r=(0,a.kZ)();r.width="1050px",r.data={entityId:this.firstEntityId,entity:this.firstEntity,secondEntity:this.secondEntity,secondEntityId:s,notEmptyAttributes:this.attributes,style:`${this.firstEntity}-theme`},this.dialog.open(n.n,r).afterClosed().subscribe(T=>{T&&(this.selection.clear(),this.getAttributes(s))})}specifySecondEntity(s){s&&(this.specificSecondEntity=s,this.getAttributes(this.specificSecondEntity.id))}applyFilter(s){this.filterValue=s}}return u.\u0275fac=function(s){return new(s||u)(t.Y36(e.H8),t.Y36(e.xk),t.Y36(e.IQ),t.Y36(e.ff),t.Y36(e.uq),t.Y36(U.uw))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-two-entity-attribute-page"]],viewQuery:function(s,r){if(1&s&&t.Gf(f,5),2&s){let p;t.iGM(p=t.CRH())&&(r.list=p.first)}},inputs:{firstEntityId:"firstEntityId",firstEntity:"firstEntity",secondEntity:"secondEntity"},decls:4,vars:3,consts:[[1,"mt-3"],["class","ml-auto mr-auto",4,"ngIf"],["alert_type","warn",4,"ngIf"],[4,"ngIf"],[1,"ml-auto","mr-auto"],["alert_type","warn"],[1,"flex-row"],[3,"firstSelectedGroup","displayStatus","groups","groupSelected",4,"ngIf"],[3,"resources","resourceSelected",4,"ngIf"],[3,"members","memberSelected",4,"ngIf"],[3,"facilities","facilitySelected",4,"ngIf"],[3,"users","userSelected",4,"ngIf"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2","action-button",3,"click"],["color","accent","mat-flat-button","",1,"mr-2",3,"disabled","click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"placeholder","filter"],[3,"attributes","filterValue","selection",4,"ngIf"],[3,"firstSelectedGroup","displayStatus","groups","groupSelected"],[3,"resources","resourceSelected"],[3,"members","memberSelected"],[3,"facilities","facilitySelected"],[3,"users","userSelected"],[3,"attributes","filterValue","selection"],["list",""]],template:function(s,r){1&s&&(t.TgZ(0,"div",0),t.YNc(1,y,1,0,"mat-spinner",1),t.YNc(2,B,2,1,"perun-web-apps-alert",2),t.YNc(3,Q,20,19,"div",3),t.qZA()),2&s&&(t.xp6(1),t.Q6J("ngIf",r.loading),t.xp6(1),t.Q6J("ngIf",0===r.entityValues.length&&!r.loading),t.xp6(1),t.Q6J("ngIf",0!==r.entityValues.length))},dependencies:[G.O5,C.lW,P.Ou,E.w,Z.t,F.L,A.p,v.h,m.L,d,b,l.S,I.X$],styles:[".w-35[_ngcontent-%COMP%]{width:35%}"]}),u})()},71135:(W,x,i)=>{i.d(x,{L:()=>G});var e=i(94650),_=i(65412),S=i(94364),D=i(36895),a=i(97392),L=i(3238),n=i(89383),N=i(64597);function t(C,P){if(1&C&&(e.TgZ(0,"div",3)(1,"a",4),e.ALo(2,"multiWordDataCy"),e.ALo(3,"translate"),e._UZ(4,"mat-icon",5),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&C){const E=P.$implicit;e.xp6(1),e.Gre("",E.style," item-itself"),e.Q6J("routerLink",E.url),e.uIk("data-cy",e.lcZ(2,7,e.lcZ(3,9,E.label))),e.xp6(3),e.Q6J("svgIcon",E.cssIcon),e.xp6(1),e.hij(" ",e.lcZ(6,11,E.label)," ")}}function U(C,P){if(1&C&&(e.TgZ(0,"div",1),e.YNc(1,t,7,13,"div",2),e.qZA()),2&C){const E=e.oxw();e.xp6(1),e.Q6J("ngForOf",E.items)}}let G=(()=>{class C{constructor(E,Z){this.dialog=E,this.route=Z,this.size="large"}ngOnInit(){this.route.params.subscribe(E=>{this.voId=Number(E.voId)})}}return C.\u0275fac=function(E){return new(E||C)(e.Y36(_.uw),e.Y36(S.gz))},C.\u0275cmp=e.Xpm({type:C,selectors:[["perun-web-apps-menu-buttons-field"]],inputs:{items:"items",size:"size"},decls:1,vars:1,consts:[["class","items-container",4,"ngIf"],[1,"items-container"],["class","item-itself-container","mat-ripple","",4,"ngFor","ngForOf"],["mat-ripple","",1,"item-itself-container"],["queryParamsHandling","merge",3,"routerLink"],[1,"item-pic","perun-icon",3,"svgIcon"]],template:function(E,Z){1&E&&e.YNc(0,U,2,1,"div",0),2&E&&e.Q6J("ngIf","small"===Z.size)},dependencies:[D.sg,D.O5,S.yS,a.Hw,L.wG,n.X$,N.R],styles:[".items-container[_ngcontent-%COMP%]{display:grid;grid-gap:0;grid-template-columns:repeat(auto-fill,minmax(208px,1fr));margin:0 -8px}@media (max-width: 768px){.items-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(148px,1fr))}}.item-pic[_ngcontent-%COMP%]{color:currentColor;transform:scale(3);height:74px;margin-bottom:22px}.item-itself-container[_ngcontent-%COMP%]{margin:8px}.item-itself[_ngcontent-%COMP%]{text-align:center;min-height:186px;height:100%;padding:20px;display:flex;flex-direction:column;align-items:center;font-size:1.25rem}.item-itself[_ngcontent-%COMP%]:hover{text-decoration:none}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:120px;margin-bottom:10px}@media (max-width: 768px){.item-itself[_ngcontent-%COMP%]{min-height:150px;padding:10px}.item-itself[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:80px;margin-bottom:10px}}"]}),C})()}}]);